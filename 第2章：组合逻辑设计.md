# 第2章：组合逻辑设计 - 读书笔记

## 2.1 引言

### 电路定义
- **电路**处理离散值变量，包含：
  - 输入/输出端子
  - 功能规范（输入输出关系）
  - 时序规范（输入变化到输出响应的延迟）

### 电路组成
- **元件**：具有输入、输出和规范的电路
- **节点**：传输离散值变量的导线
  - 输入节点：从外部世界接收值
  - 输出节点：向外部世界传递值
  - 内部节点：既不是输入也不是输出的导线

### 组合电路与时序电路
- **组合电路**：输出仅取决于当前输入（无记忆）
- **时序电路**：输出取决于当前和先前输入（有记忆）

### 组合电路构成规则
电路是组合电路的条件：
1. 每个电路元件本身都是组合电路
2. 电路的每个节点要么被指定为电路输入，要么连接到恰好一个电路元件的输出端子
3. 电路不包含循环路径：通过电路的每条路径最多访问每个电路节点一次

### 总线表示法
- 带斜线和数字的单线表示**总线**（信号束）
- 示例：`A[3:0]` 表示4位总线

## 2.2 布尔方程

### 术语
- **补码**：变量的逆（`A`）
- **文字**：变量或其补码（`A`, `A`, `B`, `B`）
- **蕴含项**：一个或多个文字的AND（`AB`, `ABC`, `B`）
- **最小项**：涉及函数所有输入的乘积（对于3变量函数为`ABC`）
- **最大项**：涉及函数所有输入的和（对于3变量函数为`A+B+C`）

### 运算符优先级
1. NOT（最高）
2. AND
3. OR（最低）

### 规范形式
#### 积之和（SOP）
- 输出为TRUE的所有最小项的和
- 示例：`Y = A·B + A·B` 或 `Y = Σ(m1, m3)`

#### 和之积（POS）
- 输出为FALSE的所有最大项的积
- 示例：`Y = (A+B)·(A+B)` 或 `Y = Π(M0, M2)`

### 选择指南
- 当输出TRUE的行较少时使用SOP
- 当输出FALSE的行较少时使用POS

## 2.3 布尔代数

### 公理（基本规则）
- A1: 如果B≠1则B=0    A1': 如果B≠0则B=1
- A2: 0 = 1            A2': 1 = 0
- A3: 0·0 = 0          A3': 1+1 = 1
- A4: 1·1 = 1          A4': 0+0 = 0
- A5: 0·1 = 1·0 = 0    A5': 1+0 = 0+1 = 1

### 关键定理

#### 单变量定理
- **恒等定理**：`B·1 = B`, `B+0 = B`
- **零元素定理**：`B·0 = 0`, `B+1 = 1`
- **幂等定理**：`B·B = B`, `B+B = B`
- **对合定理**：`B = B`
- **互补定理**：`B·B = 0`, `B+B = 1`

#### 多变量定理
- **交换律**：`B·C = C·B`, `B+C = C+B`
- **结合律**：`(B·C)·D = B·(C·D)`, `(B+C)+D = B+(C+D)`
- **分配律**：`B·(C+D) = (B·C)+(B·D)`, `B+(C·D) = (B+C)·(B+D)`
- **覆盖定理**：`B·(B+C) = B`, `B+(B·C) = B`
- **合并定理**：`(B·C)+(B·C) = B`, `(B+C)·(B+C) = B`
- **共识定理**：`(B·C)+(B·D)+(C·D) = (B·C)+(B·D)`
- **德摩根定理**：`(B·C) = B + C`, `(B+C) = B · C`

### 证明方法
- **完全归纳法**：通过测试所有可能的输入组合来证明
- 方程最小化目标：最少的蕴含项和最少的文字

## 2.4 从逻辑到门电路

### 原理图指南
- 输入在左/上，输出在右/下
- 门电路从左向右流动
- 尽可能使用直导线
- 导线在T型连接处连接
- 圆点表示连接，没有圆点的交叉不连接

### 实现风格
- **两级逻辑**（SOP形式）：NOT → AND → OR
- **可编程逻辑阵列（PLA）**：系统排列的反相器、AND门和OR门
- **CMOS优化**：优先使用NAND/NOR门而不是AND/OR门

### 多输出电路
- 示例：4输入优先级电路
- 通过检查得到输出方程：`Y3 = A3`, `Y2 = A3·A2` 等
- **无关项（X）**：当输入组合不影响输出时使用

## 2.5 多级组合逻辑

### 优点
- 与两级逻辑相比减少硬件
- 示例：3输入XOR在两级逻辑中需要4个AND门+1个OR门，但在多级中只需要2个XOR门

### 气泡推演规则
1. 从输出开始向输入方向工作
2. 将输出气泡推回输入
3. 在门之间消除气泡
4. 推演气泡时改变门体（AND↔OR）

## 2.6 X和Z状态

### 非法值：X
- **竞争**：节点同时被驱动到0和1
- 原因：未知值、未初始化输入、冲突门
- 可能导致过度功耗和损坏

### 浮空值：Z
- **高阻抗**：节点未被驱动到任何值
- **三态缓冲器**：三种输出状态（0, 1, Z）
- **高有效/低有效使能**：控制缓冲器何时使能
- 用于多芯片系统中的共享总线

## 2.7 卡诺图

### 基本概念
- 逻辑最小化的图形方法（最多4变量）
- **格雷码排序**：相邻方格仅在一个变量上不同
- **环绕**：地图边缘被视为相邻

### 卡诺图规则
1. 使用最少的圆圈覆盖所有1
2. 圆圈必须仅包含1
3. 圆圈大小必须是2的幂（1, 2, 4, 8...）
4. 圆圈应尽可能大
5. 圆圈可以环绕边缘
6. 1可以被多次圈选

### 卡诺图中的无关项
- **X条目**：可以是0或1
- 如果X有助于形成更大的圆圈，则圈选X
- 如果X对最小化没有帮助，则忽略X

## 2.8 组合逻辑构建模块

### 多路选择器（Mux）
- **2:1 Mux**：`Y = S·D0 + S·D1`
- **4:1 Mux**：需要2条选择线
- **实现**：SOP逻辑、三态或分层2:1多路选择器
- **逻辑函数**：可以用2^N输入多路选择器实现任何N输入函数

### 译码器
- **N:2^N译码器**：N个输入，2^N个输出
- **独热输出**：任何时候恰好一个输出为HIGH
- **实现**：具有真值/补码输入的AND门
- **逻辑函数**：与OR门结合以对最小项求和

## 2.9 时序

### 关键概念
- **时序图**：显示瞬态响应
- **上升/下降沿**：LOW→HIGH和HIGH→LOW转换
- **50%点**：延迟的测量参考点

### 延迟类型
- **传播延迟（tpd）**：最大输入到输出延迟
- **污染延迟（tcd）**：最小输入到输出延迟
- **关键路径**：通过电路的最长路径（决定tpd）
- **短路径**：通过电路的最短路径（决定tcd）

### 毛刺
- **原因**：不同的路径延迟，跨越质蕴含项边界
- **解决方案**：添加共识项，但不总是可修复
- **影响**：如果等待传播延迟结束，通常无害

## 2.10 总结

### 关键点
- 组合电路：输出仅取决于当前输入
- 布尔代数：逻辑简化的基础
- 卡诺图：可视化最小化工具（2-4变量）
- 构建模块：多路选择器、译码器、优先级电路
- 时序：对电路性能至关重要
- 现代实践：CAD工具处理大型优化

### 实现选择
- **两级vs多级**：速度与硬件的权衡
- **门类型**：CMOS中优先使用NAND/NOR
- **设计约束**：面积、速度、功耗、成本
